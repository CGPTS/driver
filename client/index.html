<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>אמת או חובה - משחק משפחתי</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="אמת או חובה">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.png">
    <link rel="apple-touch-icon" href="icons/icon-180x180.png">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>🎮 אמת או חובה</h1>
            <p class="subtitle">משחק משפחתי מהנה</p>
            <div class="connection-status" id="connectionStatus">🔌 מתחבר...</div>
        </div>

        <!-- מסך בחירת מוד -->
        <div id="modeSelectionScreen" class="screen active">
            <div class="mode-content">
                <div class="game-icon">🎯</div>
                <h2>בחר אופן משחק</h2>
                <div class="mode-buttons">
                    <button class="mode-btn local-btn" onclick="selectMode('local')">
                        <span class="mode-icon">📱</span>
                        <span class="mode-title">משחק מקומי</span>
                        <span class="mode-desc">כולם על מכשיר אחד</span>
                        <div class="btn-glow"></div>
                    </button>
                    <button class="mode-btn online-btn" onclick="selectMode('online')">
                        <span class="mode-icon">🌐</span>
                        <span class="mode-title">משחק מקוון</span>
                        <span class="mode-desc">כל אחד מהמכשיר שלו</span>
                        <div class="btn-glow"></div>
                    </button>
                </div>
            </div>
        </div>

        <!-- מסך יצירת/הצטרפות לחדר -->
        <div id="roomScreen" class="screen">
            <div class="room-content">
                <div class="room-options">
                    <button class="room-btn create-btn" onclick="showCreateRoom()">
                        <span>🏠 צור חדר חדש</span>
                        <div class="btn-glow"></div>
                    </button>
                    <button class="room-btn join-btn" onclick="showJoinRoom()">
                        <span>🚪 הצטרף לחדר</span>
                        <div class="btn-glow"></div>
                    </button>
                </div>

                <!-- יצירת חדר -->
                <div id="createRoomSection" class="room-section hidden">
                    <h3>צור חדר משחק</h3>
                    <input type="text" id="playerName" placeholder="הכנס את השם שלך" maxlength="20">
                    <button class="action-btn" onclick="createRoom()">
                        <span>צור חדר</span>
                        <div class="btn-glow"></div>
                    </button>
                </div>

                <!-- הצטרפות לחדר -->
                <div id="joinRoomSection" class="room-section hidden">
                    <h3>הצטרף לחדר</h3>
                    <input type="text" id="joinPlayerName" placeholder="הכנס את השם שלך" maxlength="20">
                    <input type="text" id="roomCode" placeholder="קוד החדר" maxlength="6">
                    <button class="action-btn" onclick="joinRoom()">
                        <span>הצטרף</span>
                        <div class="btn-glow"></div>
                    </button>
                </div>

                <button class="back-btn" onclick="backToModeSelection()">
                    <span>🔙 חזור</span>
                </button>
            </div>
        </div>

        <!-- מסך חדר הממתנה -->
        <div id="waitingRoomScreen" class="screen">
            <div class="waiting-content">
                <h2>חדר משחק</h2>
                <div class="room-info">
                    <div class="room-code-display">
                        <span>קוד החדר:</span>
                        <span class="room-code" id="displayRoomCode">----</span>
                        <button class="copy-btn" onclick="copyRoomCode()">📋</button>
                    </div>
                </div>
                
                <div class="players-section">
                    <h3>שחקנים בחדר (<span id="playerCount">0</span>)</h3>
                    <div class="players-list" id="playersList"></div>
                </div>

                <div class="waiting-actions">
                    <button class="start-game-btn" id="startGameBtn" onclick="startOnlineGame()" disabled>
                        <span>התחל משחק</span>
                        <div class="btn-glow"></div>
                    </button>
                    <button class="leave-room-btn" onclick="leaveRoom()">
                        <span>🚪 עזוב חדר</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- מסך התחלה (למשחק מקומי) -->
        <div id="startScreen" class="screen">
            <div class="start-content">
                <div class="game-icon">🎯</div>
                <h2>בואו נתחיל!</h2>
                <p>כולם מניחים את האצבע על המסך יחד</p>
                <button class="start-btn" onclick="startLocalGame()">
                    <span>התחל משחק</span>
                    <div class="btn-glow"></div>
                </button>
                <button class="back-btn" onclick="backToModeSelection()">
                    <span>🔙 חזור</span>
                </button>
            </div>
        </div>

        <!-- מסך זיהוי מגע/הצבעה -->
        <div id="touchScreen" class="screen">
            <div class="touch-area" id="touchArea">
                <div class="timer" id="timer">3</div>
                <div class="instruction" id="instruction">מניחים את האצבע על המסך...</div>
                <div class="touches-container" id="touchesContainer"></div>
                
                <!-- כפתור הצבעה למשחק מקוון -->
                <div class="vote-section" id="voteSection" style="display: none;">
                    <button class="vote-btn" id="voteBtn" onclick="castVote()">
                        <span>🗳️ הצבע!</span>
                        <div class="btn-glow"></div>
                    </button>
                    <div class="voters-list" id="votersList"></div>
                </div>
            </div>
        </div>

        <!-- מסך הבחירה -->
        <div id="choiceScreen" class="screen">
            <div class="choice-content">
                <div class="selected-player">
                    <h2 id="selectedPlayerName">🎉 נבחרת!</h2>
                    <p>בחר את האתגר שלך:</p>
                </div>
                <div class="choice-buttons">
                    <button class="choice-btn truth-btn" onclick="showQuestion('truth')">
                        <span>🤔 אמת</span>
                        <div class="btn-shine"></div>
                    </button>
                    <button class="choice-btn dare-btn" onclick="showQuestion('dare')">
                        <span>💪 חובה</span>
                        <div class="btn-shine"></div>
                    </button>
                </div>
            </div>
        </div>

        <!-- מסך השאלה -->
        <div id="questionScreen" class="screen">
            <div class="question-content">
                <div class="question-type" id="questionType"></div>
                <div class="question-text" id="questionText"></div>
                <button class="next-btn" onclick="nextRound()">
                    <span>סבב הבא</span>
                    <div class="btn-glow"></div>
                </button>
            </div>
        </div>
    </div>

    <!-- Socket.IO -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>